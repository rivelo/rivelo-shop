<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Нові надходження</title>
{% load template_math %}

<link rel="stylesheet" type="text/css" href="/media/table.css">
<script type="text/javascript" src="/media/jquery-1.7.2.min.js"></script>
<script src="/media/jquery.jeditable.mini.js" type="text/javascript" charset="utf-8"></script>

<link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>



<!--   <body onLoad="res()"> -->
<body>
<script type="text/javascript">

function res()
{
var p=0;
var All=document.forms['formSum'];
for(var i = 0; i < All.elements.length; ++i) {
	if(All.elements[i].checked){
	//p+=parseInt(All.elements[i].value);
	p=p+parseFloat(All.elements[i].value);
	}
	document.getElementById('for_pay').innerHTML = p.toFixed(2)+" грн.";
	//document.getElementById('debet').innerHTML = parseFloat(document.getElementById('for_pay').innerHTML)+parseFloat(document.getElementById('workshop_pay').innerHTML);
}
}

$(function() {
    $( "#accordion" ).accordion({
    	heightStyle: "content",
    	collapsible: true
    });
    $( ".selector" ).accordion({ animate: false });
    $('#ui-id-1').remove();
    $('#ui-id-2').remove();

    $('.edit').editable('/dealer/invoice/new/edit/', {
     	 id   : 'id',
         name : 'rcount',
         
         submitdata : function() {
      	 	return {id : $(this).attr('id_rcount')};
    	 },
         indicator : 'Saving...',
         tooltip   : 'Click to edit...',
         select : true,
         callback : function(value, settings) {
         var obj = jQuery.parseJSON(value);
         $(this).html(obj.value);
         //$(this).html(value);
         //$("#userid").html(obj.user);
         document.getElementById('userid'+obj.id).innerHTML = obj.user;
         if (obj.value == parseFloat(document.getElementById('count'+obj.id).innerHTML)) {
         	document.getElementById('row'+obj.id).style.backgroundColor = "#9fbb31";
         }    
         else {
         	document.getElementById('row'+obj.id).style.backgroundColor = "#FFFFFF";
         }
     }
     });

        $("#test").click(function() {
            // AJAX-запит на потрібну адресу
            $.get("/xhr_test/", function(data) {
                // Замінюємо текст тегу з id="target" на отримані дані
                $("#target").html(data.param1+' '+data.param2);
            });
        });

});   
</script>
<br>    

{% comment %} 
<a id="test" href="javascript:">Натисни мене</a>

<!-- Елемент, текст якого буде змінено -->
<div id="target">Я готовий до змін.</div>
{% endcomment %}

<div id="accordion">
<h3>EMPTY{{x.invoice.origin_id}}</h3> <div> <table>
<tr>
	<th>#</th>
   	<th>[ID] - Назва </th>
  	<th>Кількість</th>
   	<th>Накладна</th>
   	<th>Статус</th>
   	<th>Наявна кількість</th>
   	<th>Користувач</th>
</tr>

{% for x in dinvoice_list %}
{% ifchanged x.invoice %}  
</table></div> 
<h3>{{x.invoice.origin_id}}</h3> <div> <table>
<tr>
	<th>#</th>
   	<th>[ID] - Назва </th>
  	<th>Кількість</th>
   	<th>Накладна</th>
   	<th>Статус</th>
   	<th style="width:80px">Наявна кількість</th>
   	<th>Користувач</th>
</tr> 
{% endifchanged %}
{% ifequal x.count x.rcount %}
<tr id=row{{x.id}}  bgcolor="#9fbb31">
{% else %}
<tr id=row{{x.id}}>
{% endifequal %}
<td>{{forloop.counter}}</td>
<td>{{x.catalog}}</td>
<td id="count{{x.id}}" align="center">{{x.count}} шт.</td>
<td>{{x.invoice.origin_id}}</td>
<td align="center">{{x.invoice.received|default:"В дорозі"}}</td>

{% if user.is_authenticated %}
	<td class="edit" id_rcount="{{x.id}}" align="center">
{% else %}
	<td id_rcount="{{x.id}}" align="center">
{% endif %}       
{{x.rcount}}
</td>

<td id="userid{{x.id}}" align="center">{{x.user}}</td>
</tr>

{% endfor %}

</table>
</div>

</div>

